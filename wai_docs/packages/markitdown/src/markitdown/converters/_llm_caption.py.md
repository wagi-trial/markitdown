# packages/markitdown/src/markitdown/converters/_llm_caption.py

**[‚Üê Back to Parent Directory](./README.md)**

---

<details>
<summary>üìä Documentation Metadata (click to expand)</summary>

```json
{
  "source_file": "packages/markitdown/src/markitdown/converters/_llm_caption.py",
  "file_hash": "1f59673a3214b0f02bb669b6c883166fd39f9b6fbcb0e3f777d1eb184e92b4bc",
  "last_updated": "2025-12-23T15:50:54.737801+00:00",
  "functions": {}
}
```

</details>



The Python file `packages/markitdown/src/markitdown/converters/_llm_caption.py` implements a function called `llm_caption`, which generates a caption for an image by utilizing the OpenAI API. The function accepts a binary file stream and a `StreamInfo` object that contains metadata about the image, such as its MIME type and file extension. It prepares the image data in a base64-encoded format and constructs a data URI to be sent to the OpenAI API along with a user-defined prompt or a default prompt if none is provided.

The primary function defined in this file is `llm_caption`, which takes four parameters: `file_stream` (a binary stream of the image), `stream_info` (an instance of `StreamInfo`), and additional keyword arguments for `client`, `model`, and an optional `prompt`. The function handles the reading and encoding of the image, constructs a message structure for the API request, and processes the API response to return the generated caption. 

The file imports several modules, including `BinaryIO` and `Union` from the `typing` module, `base64` for encoding, and `mimetypes` for determining the content type of the image. It also imports `StreamInfo` from a sibling module, which is used to retrieve metadata about the image. The function manipulates data structures such as dictionaries and lists to format the messages sent to the OpenAI API, specifically using a list of dictionaries to represent the message content and roles. The function returns either a string containing the generated caption or `None` if an error occurs during processing.

## Functions and Classes



---
*This documentation was automatically generated by AI (Woden DocBot) and may contain errors. It is the responsibility of the user to validate the accuracy and completeness of this documentation.*
